---
title: "합성곱 신경망(CNN)"
tags:
- deep_learning
---

# 들어가며
이 글은 <<밑바닥부터 시작하는 딥러닝>> 7장 합성곱 신경망(CNN) 의 내용을 정리한 포스팅입니다. 이 포스팅의 내용을 이해하려면 이 책의 이전 장을 알고 있는 게 좋습니다.
아니면, 딥러닝 신경망이 어떻게 구성되는지 대략적으로 알고 계신다면, 내용 이해에 도움이 될 거라고 생각합니다.

# 합성곱 신경망(CNN)
CNN은 Convolutional neural network의 약자로, 합성곱 신경망이라는 의미입니다. CNN은 이미지 인식과 음성 인식 등 다양한 곳에서 사용되는데요. 특히 이미지 인식 분야에서 광범위하게 사용되고 있습니다.
이 장에서는 CNN의 메커니즘을 설명하고 파이썬으로 어떻게 구현하는지 확인해 볼 예정입니다.

## 전체 구조
- CNN도 일반적인 딥러닝과 구조는 같습니다.
    - 즉 어파인 연산 > 활성화 함수(시그모이드 or ReLU) 의 레이여가 연속되어 있는 구조입니다.
    - 다만 합성곱 계층과 풀링 계층이 새롭게 등장합니다.

지금까지 신경망의 구조는 다음과 같았습니다.

<div class="mermaid">
graph LR;
    Affine1 -->ReLU1
    ReLU1 --> Affine2
    Affine2 -->ReLU2
    ReLU2 --> Affine3
    Affine3 -->SoftMax
</div>

CNN 또한 비슷합니다. 다만 새로운 계층이 추가됩니다.

<div class="mermaid">
graph LR;
    Conv1 -->ReLU1
    ReLU1 --> Polling1
    Polling1 --> Conv2
    Conv2 -->ReLU2
    ReLU2 --> Polling2
    Polling2 --> Affine3
    Affine3 --> softmax
</div>

새롭게 합성곱 계층(Conv)와 폴링 계층(Polling) 이 추가됩니다. 특징은 다음과 같습니다.

- 폴링 계층은 생략될 수도 있다.
- 출력에 가까운 층에서는 Affine - ReLU 레이어를 사용할수도 있다.
- 마지막 출력 계층에서는 Affine - Softmax 조합을 사용할수도 있다.

## 합성곱 계층(Conv)
지금까지 본 완전연결 신경망에서는 Affine 계층을 사용하였습니다. 이 신경망에서는, 인접하는 계층의 뉴런이 모두 연결되고 출력의 수는 임의로 정할 수 있습니다.
이 방식은 문제점이 있습니다. 바로 데이터의 형상이 무시된다는 것입니다.

예를 들면 MNIST 데이터셋은 (1, 28, 28)의 3차원 데이터셋이지만, 데이터를 입력할 때는 위의 픽셀을 일렬로 세운 1 * 28 * 28 = 784개의 데이터를 Affine 계층에 입력했습니다.
이미지는 3차원 형상이며, 픽셀 사이의 관계에도 여러 가지 정보가 담겨 있습니다. 공간적으로 가까운 픽셀은 값이 비슷하다던지, RGB 각 채널은 밀접하게 관련되어 있다던지 하는 데이터입니다.
완전연결 신경망에서는 위의 성질을 무시하게 됩니다. 그러나, 합성곱 계층은 형상을 유지합니다. 이미지도 3차원 데이터로 입력받으며 마찬가지로 다음 계층에도 3차원 데이터로 전달합니다.

합성곱 계층에서 사용하는 용어 정리를 간단하게 하고 넘어가겠습니다. 이 용어는 앞으로 여러 번 나올 예정입니다.

- 특징 맵(feature map) : 합성곱 계층의 입출력 데이터
- 입력 특징 맵(input feature map) : 합성곱 계층의 입력 데이터
- 출력 특징 맵(output feature map) : 합성곱 계층의 출력 데이터

### 합성곱 연산
합성곱 연산은 이미지 처리에서 말하는 필터 연산에 해당합니다. 구체적인 예를 보며 설명하겠습니다.

| 1 | 2 | 3 | 0 |                     
|---|---|---|---|
| 0 | 1 | 2 | 3 |                     
| 3 | 0 | 1 | 2 |
| 2 | 3 | 0 | 1 |

\\[ 
\begin{table}[]
\centering
\caption{My caption}
\label{my-label}
\begin{tabular}{|l|l|l|}
\hline
2 & 0 & 1 \\ \hline
0 & 1 & 2 \\ \hline
1 & 0 & 2 \\ \hline
\end{tabular}
\end{table} 
]\\


