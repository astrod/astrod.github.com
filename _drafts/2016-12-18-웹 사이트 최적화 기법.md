---
title: "웹 사이트 최적화 기법"
tags:
- book
---

# 들어가며
<<웹 사이트 최적화 기법>>은 웹 사이트의 성능을 높이기 위한 열 네 가지 방법을 소개하고 있다. 책은 명저이지만, 초판이 2008년도에 출간되어서
현재 웹 환경에 맞는 부분도 있고, 그렇지 않은 부분도 있다고 생각한다.
예를 들면, CSS Expression을 피하라는 지침이 있는데, 아직까지 일을 하면서 CSS Expression을 사용하는 곳을 찾지 못한 거 같다.

이러한 자의적인 규정을 통해, 열 네 가지 방법 중에 현재에는 비중이 조금 떨어진다고 생각하는 규칙을 쳐내고 남은 규칙들을 정리한 후에, 현대 브라우저에서도
이런 규칙들이 제대로 동작하는지 알아보는 것이 이 포스팅의 목표이다.

# HTTP 요청을 줄여라
페이지 디자인 변경 없이 HTTP 요청을 줄이는 방법에 대해 이야기하고 있다. 주로 이미지 파일을 여러 번 요청하는 대신에, 한 번만 요청하여
사용할 수 있는 기법에 대해 이야기하고 있다. 

## CSS Sprite
사용하는 이미지를 하나의 파일로 묶어서 원격 서버에 배포한다. 그 다음에 background-position을 이용하여 필요한 부분을 잘라서 사용한다.

~~~
<div style="background-image: url('a_lot_of_sprites.gif');
            background-position: -260px -90px
            width: 26px; height: 24px;"
</div>
~~~

이 경우, 분리된 이미지를 사용하는 것보다 57% 빠르다.

### 단점
성능상으로는 잇점이 있지만, 단점 또한 존재한다.

- 

## 스크립트와 스타일시트의 결합
스크립트와 스타일시트를 분리하지 않고 하나로 합쳐서 클라이언트로 내려준다.
또한 모든 js를 하나로 만들어서 배포하는 것 또한 성능에 좋지 않다. 사용하지 않는 js까지 다운로드 받을 수 있기 때문이다.

- 개발 시에는 페이지마다 js를 따로 사용하고, 배포 시에 모듈을 합쳐서 서버로 배포한다.
- js를 하나로 만들어서 배포하기보다는, 각각 페이지에서 사용할 모듈 조합을 만드는 게 좋다.
    - 하나로 만들어서 배포하면 필요하지 않은 파일까지 다운로드 받기 되기 때문
    - 페이지가 여러 개인 웹 페이지에서는 주로 열두 개 가량의 모듈 조합이 필요함 (경험적)

## 최근에는
더 중요해졌다. 이유는 다음과 같다.

- 글로벌 서비스에서는 레이턴시를 줄일 방법이 없기 때문
    - 클라이언트가 뉴욕, 서버가 런던에 있는 경우 TCP 커넥션을 맺게 되면 최소 56ms가 소비됨
    - 대부분의 시스템은 300ms 이상이 되면, 시스템을 느리다고 인식하게 됨
- 요청을 맺고 끊는데 드는 비용이 크기 때문(Three-hand shake)

### 서버 개선 방안
- 파이프라이닝
    - 파이프라이닝은 구현하기가 어려움
- 도메인 샤딩
    - 한 도메인당 최대 두 개 까지의 커넥션이 가능했지만, 현재는 일반적으로 최대 여섯 개까지의 병렬 커넥션 가능
    - 현재는 성능 이슈 때문에 잘 사용하지 않음.
    - HTTP 2.0에서는 Connection Coalescing 을 통하여, 도메인 샤딩을 되돌리게 됨.
        
- MultiPlexed streams(HTTP 2.0)
    - 

### CSS Sprite
- 이미지를 하나로 합쳐서 배포하는 기술은 아직도 여러 곳에서 사용중
- grunt-spritesmith 를 이용하여, 자동으로 이미지 스프라이트가 되게 할 수 있다.
    - 특정 폴더에 이미지를 넣어 두고, grunt task를 실행하면 자동으로 이미지를 sprite 할 수 있다.

### 스크립트 압축
- 의존성 있는 스크립트를 하나로 합칠 수 있게 하는 다양한 라이브러리 존재
- Webpack
    - CommonJS와 AMD 두 가지 의존성 관리 포멧을 모두 지원함
    - 의존성 있는 모듈끼리 합쳐서 하나의 js 파일로 만들 수 있음
    - [webpack](http://d2.naver.com/helloworld/0239818)
    - 이외에도 다양한 기능 제공
        - 로더
        - 모듈 의존성 관리




